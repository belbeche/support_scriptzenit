{% extends 'base.html.twig' %}


{% block content %}

	<div class="container">
		{% for type, messages in app.flashes %}
			{% for message in messages %}
				<div class="alert alert-{{ type }}">{{ message }}</div>
			{% endfor %}
		{% endfor %}
	</div>

	<!-- introduction + search -->
	<section id="hero" class="promo">
		<div class="container text-center">
			<h2 class="title">dev<span class="highlight">Blog</span>
			</h2>
			<div class="container pt-xxl-5 intro">
				{{ render(controller('App\\Controller\\Front\\FrontController::search')) }}
			</div>
			<ul class="meta list-inline list-group-item">
				{% for categorie in categories %}
					<li class="list-inline-item">
						<a href="{{ url('front_category', {name: categorie.name}) }}">
							{{ categorie.name }}
						</a>
					</li>
				{% endfor %}
			</ul>
		</div>
	</section>

	<div class="jumbotron bg-primary">
		<h3 class="lead text-white text-center">Les derniers articles</h3>
	</div>


	<!-- Blog start -->
	<div class="container">
		<section
			id="promo" class="section offset-header">
			<!-- blog start -->
			<section class="blog-area pb-5">
				<div class="container">
					<div class="row justify-content-center">
						{% for article in articles %}
							<div class="col-lg-3 col-md-3 col-sm-10">
								<div class="single-blog blog-style-one">
									<div class="blog-image">
										<a href="{{ path('front_articles_show', {'slug': article.slug}) }}">
											{% for image in article.images %}
												<img class="card-img-top rounded-0" src="{{ asset('uploads/' ~ image.name) }}" alt="{{ article.title }}">
											{% endfor %}
										</a>
									</div>
									<div class="blog-content">
										<h5 class="blog-title">
											<a href="{{ path('front_articles_show', {'slug': article.slug}) }}">
												<h5 class="card-title">{{ article.title }}</h5>
											</a>
										</h5>
										{% for categorie in article.categories %}
											{{ categorie.name }}
										{% endfor %}
										<br>
										<span>
											<i class="bi bi-calendar"></i>
											{{ article.createdAt|format_datetime('medium', locale="fr") }}</span>
										<span>
											<i class="bi bi-chat-dots"></i>
											{{ article.commentaires|length }}</span>
										<span class="favoris">
											<i class="bi bi-heart-fill"></i>
											{{ article.favoris|length }}</span>
										<span><img src="{{ asset('uploads/avatar/' ~article.user.avatar) }}" alt="{{ article.user.username }}" class="rounded-0 img-thumbnail" width="50" height="50">
											{{ article.user.username }}</span>
									</div>
									<div>
										{% if app.user %}
											{% set isFavorite = false %}
											{% for favoris in article.favoris %}
												{% if favoris.id == app.user.id %}
													{% set isFavorite = true %}
												{% endif %}
											{% endfor %}
											{% if isFavorite %}
												<button class="btn-favorite" type="button" data-href="{{ url('front_remove_favoris', {id: article.id}) }}" data-id="{{ article.id }}">
													<i class="bi bi-hand-thumbs-up-fill"></i>
												</button>
											{% else %}
												<button class="btn-favorite" type="button" data-href="{{ url('front_add_favoris', {id: article.id}) }}" data-id="{{ article.id }}">
													<i class="bi bi-hand-thumbs-up"></i>
												</button>
											{% endif %}

										{% endif %}
									</div>
								</div>
							</div>
						{% endfor %}
					</div>
				</div>
			</section>
		</div>
		<!-- ./ End blog start -->
	</div>

	<div class="navigation pagination justify-content-center my-4">
		{{ knp_pagination_render(articles) }}
	</div>

{% endblock %}
