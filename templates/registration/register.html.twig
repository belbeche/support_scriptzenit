{% extends 'base.html.twig' %}

{% block title %}- Inscription -{% endblock %}

{% block content %}

    <div class="container pt-4">

        {% if not registrationForm.vars.valid %}
            <ul class="alert alert-danger">
                {# on affiche en premier les erreurs globales (cas classiques) #}
                {% for error in registrationForm.vars.errors %}
                    <li>{{error.message}}</li>
                {% endfor %}
                {# ainsi que les erreurs concernant chaque champs #}
                {% for child in registrationForm.children %}
                    {# si le champ à des erreur #}
                    {% if child.vars.errors is defined %}
                        {% for error in child.vars.errors %}
                            <li>"{{child.vars.label}}" : {{error.message}} </li> {# on ajoute le label du champ devant l'erreur pour plus de précisions. #}
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            </ul>
        {% endif %}

        {% if app.user %}
            <div class="mb-3">
                Tu es connecté en tant que {{ app.user.username }}, <a href="{{ url('app_logout') }}">Déconnecte toi</a>
            </div>
        {% else %}

        {% for flash_error in app.flashes('verify_email_error') %}
            <div class="alert alert-danger" role="alert">{{ flash_error }}</div>
        {% endfor %}

        <h1 class="h3 mb-3 font-weight-normal">Inscription</h1>

        {{ form_start(registrationForm) }}
        <label for="">Nom d'utilisateur</label>
        {{ form_widget(registrationForm.username) }}
        <label for="">Email</label>
        {{ form_widget(registrationForm.email) }}
        <label for="">Mot de passe</label>
        {{ form_widget(registrationForm.plainPassword) }}
        <label for="">Role</label>
        {{ form_widget(registrationForm.roles, {'attr' : {'class': 'selectpicker'}}) }}
        <br>
        {{ form_widget(registrationForm.agreeTerms) }}

        {{ form_rest(registrationForm) }}


        <button type="submit" class="btn btn-outline-success">Je valide</button>
        {{ form_end(registrationForm) }}
        {% endif %}
    </div>

{% endblock %}
